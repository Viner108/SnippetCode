1. Заходим Visual Studio и создаем новый проект. В шаблонах выбираем Библиотека динамической компановки с экспортом. Не забываем менять называние и расположение файла
2. Создается проект. В обозревателе решений кликаем на название проекта правтой кнопкой мыши. Открываем свойства. Смотрим тип конфигурации и выбираем нужный. Нажимаем Ок
3. В обозревателе решений кликаем на название проекта правтой кнопкой мыши. И выбираем Добавить -> Модуль.
4. В открывшемся окне выбираем Файл заголовка(.h) Внизу присываем его название и нажимаем Добавить.
5. В созданном файле объявляем функции нашей будущей библиотеки.
Пример: extern "C" __declspec(dllexport) int sum(int);
6. Далее повторяем пункты 3 и 4 только вместо Файл заголовка(.h) выбираем Файл С++(.срр).
7. В созданном файле раписываем реализацию функций из заголовочного файла. Не забываем писать #include "Название заголовочного файла.h", #include "pch.h" - без этого наша библиотека не собиреться
8. Далее в обозревателе решений кликаем на название проекта правтой кнопкой мыши и нажимаем Собрать. Далее наша библеотека появиться в проекте в файле Degub или Release взависимости от выбора конфигурации
9. На этом работа с самой библиотекой закончена и приступаем к испольняемому файлу.
10.Заходим Visual Studio и создаем новый проект. В шаблонах выбираем Консольное приложениею. Не забываем менять называние и расположение файла.
11.Создается проект. Повторяем пункут 6 для создание файла.
12.Туда уже вписать код только он не будет компилироваться. В файле незабываем написать #include "Название заголовочного файла библиотеки.h"
13.В обозревателе решений кликаем на название проекта правтой кнопкой мыши. Открываем свойства. И с правой сторны выбираем C/C++ю.
14.В открывшемся окне смотрим пункт Дополнительные каталоги включаемых файловю. Нажимаем на пустую стоку рядом и на после на появившуюся стрелочку. Нажимаем на появившуюся сточку <Изменить...>
15.В открывшемся окне сверху есть значок папки. Нажимаем на него и появляется сточка в которую нам надо записать путь к заголовочному файлу нашей библиотеки. После добавления внизу нажимаем Ок.
16.Далее нас возвращает в Свойства проекта. Слева ищем Компоновщик. Расскрываем его и выбираем пункт Общее.
17.Здесь нам нужна сточка Дополнительные каталоги библиотек. Повторяем пункт 14 и 15 только в этот разуказываем путь не к заголовочному файлу а каталог где лежит созданная нами библиотека
18.После в Компоновщике выбираем пункт Ввод. Здесь нам нужна строчка Дополнительные зависимости. Постояем пункт 14.
19.В открывшемся окошке в верхнем поле пишем названием нашей библиотеки с расширением .lib.
20.Последний пункт это открыть каталог где лежит сделаная библиотека и скопировать файл с расширением .dll и вставить его в каталог нашего проекта.
После этих действий ваше созданная библиотека будет подключена к вашему проекту.